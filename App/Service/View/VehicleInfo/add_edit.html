<div id="div_ftitle" class="ftitle"></div>

<form id="form_vehicle" method="post" enctype="multipart/form-data">
    <div style="width:50%;float:left;">
        <div class="fitem">
            <label>所属单位：</label>
            <input id="inp_group_id" type="text" name="group_id" style="width: 160px;height: 30px"
                   data-options="required:true"/>
            <span style="color: #CC0000;margin-left: 5px;line-height: inherit;text-align:center;font-weight: bold;">*</span>
        </div>
        <div class="fitem">
            <label>车牌号：</label>
            <input id="inp_vehicleid" name="vehicle_id" type="hidden"/>
            <input id="inp_vehicle_license" name="vehicle_license" style="width: 160px;height: 30px"/>
            <span style="color: #CC0000;margin-left: 5px;line-height: inherit;text-align:center;font-weight: bold;">*</span>
        </div>
        <div class="fitem">
            <label>车辆类别：</label>
            <input id="inp_vehicle_type" type="text" name="vehicle_type" style="width: 160px;height: 30px"/>
            <span style="color: #CC0000;margin-left: 5px;line-height: inherit;text-align:center;font-weight: bold;">*</span>
        </div>
        <div class="fitem">
            <label>车辆品牌：</label>
            <input id="inp_vehicle_brand" type="text" name="vehicle_brand" class="easyui-textbox" style="width: 160px;height: 30px"/>
        </div>
        <div class="fitem">
            <label>车辆型号：</label>
            <input id="inp_vehicle_model" type="text" name="vehicle_model" class="easyui-textbox" style="width: 160px;height: 30px"/>
        </div>
        <div class="fitem">
            <label>车辆状态：</label>
            <input id="inp_yes" type="radio" name="vehicle_state" value="1" style="margin-left: 10px"/>启用
            <input id="inp_no" type="radio" name="vehicle_state" value="0" style="margin-left: 30px"/>已停用
        </div>
        <div class="fitem">
            <label>驾驶员：</label>
            <input id="inp_vehicle_driver" name="vehicle_driver" class="easyui-textbox" type="text" maxlength="80" style="width: 160px;height: 30px"/>
        </div>
        <div class="fitem">
            <label>车辆说明：</label>
            <input id="inp_vehicle_explain" type="text" name="vehicle_explain" class="easyui-textbox" style="width: 160px;height: 30px"/>
        </div>
        <div class="fitem">
            <label>停放位置：</label>
            <input id="inp_vehicle_place" type="text" name="vehicle_place" class="easyui-textbox" style="width: 160px;height: 30px"/>
        </div>
        <div class="fitem">
            <label>购入日期：</label>
            <input id="inp_vehicle_buy_date" type="text" class="easyui-datebox"
                   data-options="editable:false,required:true" name="vehicle_buy_date" style="width: 160px;height: 30px"/><span style="color: #CC0000;margin-left: 5px;line-height: inherit;text-align:center;font-weight: bold;">*</span>
        </div>

    </div>
    <div style="width:50%;float:left;">
        <div>
            <label style="margin-left:20px;">车辆照片：</label>
            <img id="img_photo" alt="车辆照片预览" style=" width:250px; height:260px;"/>
            <input id="inp_vehicle_photo"
                   style="margin-top: 10px;margin-left:10px;border-radius:10px;-moz-border-radius:10px;
                               -ms-border-radius:10px;-o-border-radius:10px;-webkit-border-radius:10px;border:1px solid #ccc;
                               font-size:10pt;padding:5px 10px;width: 290px" class="uploadbutton" type="file" name="vehicle_photo"
                   accept="image/*" onchange="window.vehicleInfo.fileSelected();"
            />
        </div>
        <div class="fitem">
            <label>车辆平台：</label>
            <input id="inp_vehicle_from" type="text" name="vehicle_from" class="easyui-numberbox"
                   data-options="required:true" style="width: 160px;height: 30px"/><span style="color: #CC0000;margin-left: 5px;line-height: inherit;text-align:center;font-weight: bold;">*</span>
        </div>
        <div class="fitem" id="test1">
            <!--<label >设备名称：</label>-->
            <!--<input id="inp_device_name1" name="device_name" style="width: 160px;"/>-->
            <!--<input id="inp_device_name2" name="device_name" hidden style="width: 160px;"/>-->
            <!--<span style="color: #CC0000;margin-left: 5px;line-height: inherit;text-align:center;font-weight: bold;">*</span>-->
        </div>
        <div class="fitem">
            <label>购买价格(RMB)：</label>
            <input id="inp_vehicle_buy_price" type="text" name="vehicle_buy_price" class="easyui-numberbox"
                   data-options="required:false" style="width: 160px;height: 30px"/>
        </div>
    </div>
</form>

<script type="text/javascript">

    $(function () {
        $('#inp_name').textbox({
            required: true,
            validType: 'minLength[3]'
        });

        $("#inp_groupfather").combotree({
            value:1,
            url: '{:U("Admin/Function/getGroupInfosToTree")}',
            required: true,
            editable: false
        });

        var TypeData = $.parseJSON('{$_dataType}');

       // console.log(TypeData);

        var IndustryData = $.parseJSON('{$_dataIndustry}');

       // console.log(IndustryData);

        $("#inp_grouptype").combobox({
            required: true,
            data: TypeData,
            valueField: 'id',
            textField: 'text',
            editable: false,
            panelHeight: 'auto'
        });


        $("#inp_industry").combobox({
            required: true,
            data: IndustryData,
            valueField: 'id',
            textField: 'text',
            editable: false,
            panelHeight: 100
        });

        $('#inp_limitnum').numberbox({
            max: 99999,
            min: 1,
            required: true
        });


        $('#inp_responsibility_people').textbox({
            validType: 'lettersChineseDigital[20]'
        });

        $('#inp_telno').textbox({
            validType: 'phone'
        });

        $('#inp_address').textbox({
            multiline: true,
            validType: 'lettersChineseDigital[100]'
        });

        $('#inp_desc').textbox({
            multiline: true,
            validType: 'lettersChineseDigital[100]'
        });

        $('#div_ftitle').text('{$_type}');

        ////数据正确性校验
        $.extend($.fn.validatebox.defaults.rules, {
            minLength: {
                validator: function (value, param) {
                    var reg = /^[\s\u4E00-\u9FA5A-Za-z0-9-_]*$/;
                    value = $.trim(value);
                    return reg.test(value) && value.length >= param;
                },
                message: '请至少输入{0}个有效字符'
            },
            phone: {
                validator: function (value, param) {
                    var rex = /^1[3-8]+\d{9}$/;
                    //var rex=/^(([0\+]\d{2,3}-)?(0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/;
                    //区号：前面一个0，后面跟2-3位数字 ： 0\d{2,3}
                    //电话号码：7-8位数字： \d{7,8
                    //分机号：一般都是3位数字： \d{3,}
                    //这样连接起来就是验证电话的正则表达式了：/^((0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/
                    var rex2 = /^((0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/;
                    value = $.trim(value);
                    return rex.test(value) || rex2.test(value);
                },
                message: '号码有误，请重填'
            }, //字母汉字数字
            lettersChineseDigital: {
                validator: function (value, param) {
                    var reg = /^[\s\u4E00-\u9FA5A-Za-z0-9-_]*$/;
                    value = $.trim(value);
                    return reg.test(value) && value.length <= param && value.length > 0;
                },
                message: '输入内容有误'
            }
        });

        //填充表单
        function fillForm() {

            $("#form_group").form('clear');

            $("#inp_groupid").val('{$_info.group_id}');

            $("#inp_name").textbox('setValue', '{$_info.group_name}');

            $("#inp_grouptype").combobox('select', '{$_info.group_type}');

            $("#inp_industry").combobox('select', '{$_info.industry}');
//

            $("#hd_groupfatherlevel").val('{$_info.id_level}');


            if (0 == '{$_info.parent_id}') {

                $("#inp_groupfather").combotree({readonly: true});
            }
            else {
                $("#inp_groupfather").combotree({readonly: false});
            }

            $("#inp_groupfather").combotree('setValue', '{$_info.parent_id}' == 0 ? '根节点' : '{$_info.parent_id}');

            $('#inp_responsibility_people').textbox('setValue','{$_info.responsibility_people}')

            $("#inp_limitnum").numberbox('setValue', '{$_info.limit_num}');
            $("#inp_telno").textbox('setValue', '{$_info.tel_no}');
            $("#inp_address").textbox('setValue', '{$_info.address}');
            $("#inp_desc").textbox('setValue', '{$_info.description}');

        }

        if ('{$_type}' == '编辑') {
            fillForm();
        }
        else{

            $("#inp_grouptype").combobox('select', '--请选择--');
            $("#inp_industry").combobox('select', '--请选择--');
        }


    })


</script>

